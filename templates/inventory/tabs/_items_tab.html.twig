                <!-- Вкладка Элементы -->
                <div class="tab-pane fade show active" id="items" role="tabpanel" aria-labelledby="items-tab">
                    <!-- Toolbar для действий -->
                    {% if app.user and (inventory.creator == app.user or is_granted('ROLE_ADMIN') or inventory.isPublic or inventory.accesses|filter(access => access.user == app.user)|length > 0) %}
                    <div class="d-flex justify-content-between align-items-center mb-3 d-none" id="itemsToolbar">
                        <div>
                            <span id="selectedCount" class="text-muted">{{ 'items.selected_count'|trans({'%count%': 0}) }}</span>
                            <small class="text-muted d-block">{{ 'items.double_click_hint'|trans }}</small>
                        </div>
                        <div>
                            <button type="button" class="btn btn-outline-secondary btn-sm me-2 d-none" id="editSelectedBtn">
                                <i class="bi bi-pencil"></i> {{ 'items.edit_selected'|trans }}
                            </button>
                            <button type="button" class="btn btn-danger btn-sm d-none" id="batchDeleteBtn">
                                <i class="bi bi-trash"></i> {{ 'items.delete_selected'|trans }}
                            </button>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Кнопка создания элемента и экспорта -->
                    {% if app.user and (inventory.creator == app.user or is_granted('ROLE_ADMIN') or inventory.isPublic or inventory.accesses|filter(access => access.user == app.user)|length > 0) %}
                        <div class="mb-3">
                            <a href="{{ path('item_create', {'inventoryId': inventory.id}) }}" class="btn btn-primary me-2">
                                <i class="bi bi-plus-lg"></i> {{ 'items.create'|trans }}
                            </a>
                            <a href="{{ path('inventory_export_csv', {'id': inventory.id}) }}" class="btn btn-outline-success me-2">
                                <i class="bi bi-file-earmark-spreadsheet"></i> {{ 'items.export_csv'|trans }}
                            </a>
                            <a href="{{ path('inventory_export_excel', {'id': inventory.id}) }}" class="btn btn-outline-success">
                                <i class="bi bi-file-earmark-excel"></i> {{ 'items.export_excel'|trans }}
                            </a>
                            <small class="text-muted d-block mt-1">
                                <i class="bi bi-info-circle"></i> {{ 'items.edit_hint'|trans }}
                            </small>
                        </div>
                    {% endif %}

                    <!-- Поиск и фильтры элементов -->
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="itemsSearch" class="form-label">{{ 'create_inventory.search_items'|trans }}</label>
                                    <input type="text" class="form-control" id="itemsSearch" placeholder="{{ 'search.items_placeholder'|trans }}">
                                </div>
                                <div class="col-md-2">
                                    <label for="itemsSort" class="form-label">{{ 'sort.by'|trans }}</label>
                                    <select class="form-select" id="itemsSort">
                                        <option value="created_at">{{ 'sort.created_at'|trans }}</option>
                                        <option value="updated_at">{{ 'sort.updated_at'|trans }}</option>
                                        <option value="custom_id">{{ 'sort.custom_id'|trans }}</option>
                                        <option value="created_by">{{ 'sort.created_by'|trans }}</option>
                                        <option value="likes">{{ 'sort.likes'|trans }}</option>
                                        {% for i in 1..3 %}
                                            {% if attribute(inventory, 'customString' ~ i ~ 'State') %}
                                                <option value="custom_string{{ i }}">{{ 'item.sort_by_field'|trans }} {{ attribute(inventory, 'customString' ~ i ~ 'Name') }}</option>
                                            {% endif %}
                                            {% if attribute(inventory, 'customInt' ~ i ~ 'State') %}
                                                <option value="custom_int{{ i }}">{{ 'item.sort_by_field'|trans }} {{ attribute(inventory, 'customInt' ~ i ~ 'Name') }}</option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label for="itemsOrder" class="form-label">{{ 'sort.order'|trans }}</label>
                                    <select class="form-select" id="itemsOrder">
                                        <option value="desc">{{ 'sort.desc'|trans }}</option>
                                        <option value="asc">{{ 'sort.asc'|trans }}</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label for="itemsPerPage" class="form-label">{{ 'items.per_page'|trans }}</label>
                                    <select class="form-select" id="itemsPerPage">
                                        <option value="10">10</option>
                                        <option value="25" selected>25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>
                                <div class="col-md-2 d-flex align-items-end">
                                    <button type="button" class="btn btn-outline-secondary me-2" id="resetFilters">
                                        <i class="bi bi-x-circle"></i> {{ 'filters.reset'|trans }}
                                    </button>
                                    <button type="button" class="btn btn-primary" id="applyFilters">
                                        <i class="bi bi-search"></i> {{ 'filters.apply'|trans }}
                                    </button>
                                </div>
                            </div>

                            <!-- Дополнительные фильтры (сворачиваемые) -->
                            <div class="mt-3">
                                <button class="btn btn-link p-0 text-decoration-none" type="button" data-bs-toggle="collapse" data-bs-target="#advancedFilters" aria-expanded="false">
                                    {{ 'filters.advanced'|trans }} <i class="bi bi-chevron-down"></i>
                                </button>
                                <div class="collapse mt-3" id="advancedFilters">
                                    <div class="row g-3">
                                        {% for i in 1..3 %}
                                            {% if attribute(inventory, 'customString' ~ i ~ 'State') %}
                                            <div class="col-md-4">
                                                <label for="filter_custom_string{{ i }}" class="form-label">{{ attribute(inventory, 'customString' ~ i ~ 'Name') }}</label>
                                                <input type="text" class="form-control filter-input" id="filter_custom_string{{ i }}" data-field="custom_string{{ i }}" placeholder="{{ 'filters.placeholder'|trans }}">
                                            </div>
                                            {% endif %}
                                        {% endfor %}

                                        {% for i in 1..3 %}
                                            {% if attribute(inventory, 'customInt' ~ i ~ 'State') %}
                                            <div class="col-md-4">
                                                <label for="filter_custom_int{{ i }}" class="form-label">{{ attribute(inventory, 'customInt' ~ i ~ 'Name') }}</label>
                                                <input type="number" class="form-control filter-input" id="filter_custom_int{{ i }}" data-field="custom_int{{ i }}" placeholder="{{ 'filters.placeholder'|trans }}">
                                            </div>
                                            {% endif %}
                                        {% endfor %}

                                        {% for i in 1..3 %}
                                            {% if attribute(inventory, 'customBool' ~ i ~ 'State') %}
                                            <div class="col-md-4">
                                                <label for="filter_custom_bool{{ i }}" class="form-label">{{ attribute(inventory, 'customBool' ~ i ~ 'Name') }}</label>
                                                <select class="form-select filter-input" id="filter_custom_bool{{ i }}" data-field="custom_bool{{ i }}">
                                                    <option value="">{{ 'filters.all'|trans }}</option>
                                                    <option value="1">{{ 'filters.yes'|trans }}</option>
                                                    <option value="0">{{ 'filters.no'|trans }}</option>
                                                </select>
                                            </div>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Таблица элементов -->
                    <div class="table-responsive">
                        <table class="table table-striped table-hover" id="itemsTable">
                            <thead>
                                <tr>
                                    {% if app.user and (inventory.creator == app.user or is_granted('ROLE_ADMIN') or inventory.isPublic or inventory.accesses|filter(access => access.user == app.user)|length > 0) %}
                                    <th>
                                        <input type="checkbox" class="form-check-input" id="selectAllItems">
                                    </th>
                                    {% endif %}
                                    <th>
                                        <a href="#" class="text-decoration-none sort-link" data-sort="custom_id">
                                            Custom ID
                                            <i class="bi bi-chevron-expand sort-icon"></i>
                                        </a>
                                    </th>
                                    <th>
                                        <a href="#" class="text-decoration-none sort-link" data-sort="created_at">
                                            {{ 'table.created'|trans }}
                                            <i class="bi bi-chevron-expand sort-icon"></i>
                                        </a>
                                    </th>
                                    <th>{{ 'table.created_by'|trans }}</th>
                                    {% for i in 1..3 %}
                                        {% if attribute(inventory, 'customString' ~ i ~ 'State') and attribute(inventory, 'customString' ~ i ~ 'ShowInTable') %}
                                            <th>{{ attribute(inventory, 'customString' ~ i ~ 'Name') }}</th>
                                        {% endif %}

                                        {% set stateMethod = 'customText' ~ i ~ 'State' %}
                                        {% set showMethod = 'customText' ~ i ~ 'ShowInTable' %}
                                        {% set nameMethod = 'customText' ~ i ~ 'Name' %}

                                        {% if attribute(inventory, stateMethod) and attribute(inventory, showMethod) %}
                                            <th>{{ attribute(inventory, nameMethod) }}</th>
                                        {% endif %}

                                        {% set stateMethod = 'customInt' ~ i ~ 'State' %}
                                        {% set showMethod = 'customInt' ~ i ~ 'ShowInTable' %}
                                        {% set nameMethod = 'customInt' ~ i ~ 'Name' %}

                                        {% if attribute(inventory, stateMethod) and attribute(inventory, showMethod) %}
                                            <th>{{ attribute(inventory, nameMethod) }}</th>
                                        {% endif %}

                                        {% set stateMethod = 'customBool' ~ i ~ 'State' %}
                                        {% set showMethod = 'customBool' ~ i ~ 'ShowInTable' %}
                                        {% set nameMethod = 'customBool' ~ i ~ 'Name' %}

                                        {% if attribute(inventory, stateMethod) and attribute(inventory, showMethod) %}
                                            <th>{{ attribute(inventory, nameMethod) }}</th>
                                        {% endif %}

                                        {% set stateMethod = 'customLink' ~ i ~ 'State' %}
                                        {% set showMethod = 'customLink' ~ i ~ 'ShowInTable' %}
                                        {% set nameMethod = 'customLink' ~ i ~ 'Name' %}

                                        {% if attribute(inventory, stateMethod) and attribute(inventory, showMethod) %}
                                            <th>{{ attribute(inventory, nameMethod) }}</th>
                                        {% endif %}
                                    {% endfor %}
                                    <th>{{ 'table.likes'|trans }}</th>
                                </tr>
                            </thead>
                            <tbody id="itemsTableBody">
                                <!-- Элементы будут загружены через AJAX -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Пагинация -->
                    <nav aria-label="{{ 'pagination.label'|trans }}" class="mt-3" id="itemsPagination" style="display: none;">
                        <ul class="pagination justify-content-center" id="paginationControls">
                            <!-- Пагинация будет сгенерирована через JavaScript -->
                        </ul>
                    </nav>

                    <!-- Загрузка -->
                    <div id="itemsLoading" class="text-center py-4">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">{{ 'loading'|trans }}...</span>
                        </div>
                        <div class="mt-2">{{ 'loading.items'|trans }}</div>
                    </div>

                    <!-- Пустое состояние -->
                    <div id="itemsEmpty" class="text-center py-5" style="display: none;">
                        <div class="text-muted">
                            <i class="bi bi-inbox display-1"></i>
                            <h5 class="mt-3">{{ 'empty.no_items'|trans }}</h5>
                            <p>{{ 'empty.no_items_description'|trans }}</p>
                            {% if app.user and (inventory.creator == app.user or is_granted('ROLE_ADMIN') or inventory.isPublic or inventory.accesses|filter(access => access.user == app.user)|length > 0) %}
                                <a href="{{ path('item_create', {'inventoryId': inventory.id}) }}" class="btn btn-primary">
                                    <i class="bi bi-plus-lg"></i> {{ 'empty.create_first_item'|trans }}
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
